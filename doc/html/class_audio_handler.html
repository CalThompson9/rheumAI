<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Rheum AI: AudioHandler Class Reference</title>
<link rel="icon" href="logo.png" type="image/x-icon" />
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Rheum AI<span id="projectnumber">&#160;1</span>
   </div>
   <div id="projectbrief">Rheum AI is an application that uses LLM to summarize a patient-doctor</div>
  </td>
    <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('class_audio_handler.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#signals">Signals</a> &#124;
<a href="class_audio_handler-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">AudioHandler Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Singleton class for handling audio recording and transcription.  
 <a href="#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="audiohandler_8h_source.html">audiohandler.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for AudioHandler:</div>
<div class="dyncontent">
 <div class="center">
  <img src="class_audio_handler.png" alt=""/>
 </div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="signals" name="signals"></a>
Signals</h2></td></tr>
<tr class="memitem:a19a1eb8920c3589cfcf808ead869b13a" id="r_a19a1eb8920c3589cfcf808ead869b13a"><td class="memItemLeft" align="right" valign="top"><a id="a19a1eb8920c3589cfcf808ead869b13a" name="a19a1eb8920c3589cfcf808ead869b13a"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>transcriptionCompleted</b> (const QString &amp;transcribedText)</td></tr>
<tr class="separator:a19a1eb8920c3589cfcf808ead869b13a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a5b0dc8c89c2641527cb83018867c2c" id="r_a1a5b0dc8c89c2641527cb83018867c2c"><td class="memItemLeft" align="right" valign="top"><a id="a1a5b0dc8c89c2641527cb83018867c2c" name="a1a5b0dc8c89c2641527cb83018867c2c"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>microphonePermissionDenied</b> ()</td></tr>
<tr class="separator:a1a5b0dc8c89c2641527cb83018867c2c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6857eb2ddb971a895d4a78d7e9b8bd48" id="r_a6857eb2ddb971a895d4a78d7e9b8bd48"><td class="memItemLeft" align="right" valign="top"><a id="a6857eb2ddb971a895d4a78d7e9b8bd48" name="a6857eb2ddb971a895d4a78d7e9b8bd48"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>microphonePermissionGranted</b> ()</td></tr>
<tr class="separator:a6857eb2ddb971a895d4a78d7e9b8bd48"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a13cb1582538fb39147387c59785cbdbc" id="r_a13cb1582538fb39147387c59785cbdbc"><td class="memItemLeft" align="right" valign="top"><a id="a13cb1582538fb39147387c59785cbdbc" name="a13cb1582538fb39147387c59785cbdbc"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>badRequest</b> (QNetworkReply *reply)</td></tr>
<tr class="separator:a13cb1582538fb39147387c59785cbdbc"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td colspan="2"><div class="groupHeader">transcribe</div></td></tr>
<tr><td colspan="2"><div class="groupText"><p>Transcribes the audio file using Google Speech-to-Text API</p>
<p>This function checks the duration and channel count of the audio file. If the duration is longer than 60 seconds or if the audio is not stereo (2 channels), it uses the Whisper API for transcription. Otherwise, it uses Google Speech-to-Text API. It returns a <a class="el" href="class_transcript.html" title="Class to represent a transcript of a patient-doctor interaction.">Transcript</a> object containing the transcribed text. </p><dl class="section note"><dt>Note</dt><dd>The function emits a signal when the transcription is completed. </dd></dl>
<dl class="section see"><dt>See also</dt><dd>getAudioDuration </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">filename</td><td>Path to the audio file </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="class_transcript.html" title="Class to represent a transcript of a patient-doctor interaction.">Transcript</a> object containing the transcribed text </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Andres Pedreros Castro </dd>
<dd>
Callum Thompson </dd></dl>
</div></td></tr>
<tr class="memitem:aea0011010067308df83d0af31dcbac5c" id="r_aea0011010067308df83d0af31dcbac5c"><td class="memItemLeft" align="right" valign="top"><a id="aea0011010067308df83d0af31dcbac5c" name="aea0011010067308df83d0af31dcbac5c"></a>
<a class="el" href="class_transcript.html">Transcript</a>&#160;</td><td class="memItemRight" valign="bottom"><b>transcribe</b> (const QString &amp;filename)</td></tr>
<tr class="separator:aea0011010067308df83d0af31dcbac5c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr><td colspan="2"><div class="groupHeader">startRecording</div></td></tr>
<tr><td colspan="2"><div class="groupText"><p>Starts audio recording</p>
<p>This function initializes the audio input and recorder, sets the output file, and starts recording. It also requests microphone permission if not already granted. </p><dl class="section note"><dt>Note</dt><dd>The function emits a signal when the recording starts. </dd></dl>
<dl class="section see"><dt>See also</dt><dd>requestMicrophonePermission </dd>
<dd>
QAudioInput </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">outputFile</td><td>Path to the output file </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Andres Pedreros Castro </dd></dl>
</div></td></tr>
<tr class="memitem:a73b827ca25b167d545187236634bd084" id="r_a73b827ca25b167d545187236634bd084"><td class="memItemLeft" align="right" valign="top"><a id="a73b827ca25b167d545187236634bd084" name="a73b827ca25b167d545187236634bd084"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>startRecording</b> (const QString &amp;outputFile)</td></tr>
<tr class="separator:a73b827ca25b167d545187236634bd084"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr><td colspan="2"><div class="groupHeader">stopRecording</div></td></tr>
<tr><td colspan="2"><div class="groupText"><p>Stops audio recording</p>
<p>This function stops the audio recording and finalizes the output file. It can be called after recording is complete or if the user wants to stop recording. </p><dl class="section author"><dt>Author</dt><dd>Andres Pedreros Castro </dd></dl>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>
</div></td></tr>
<tr class="memitem:ae545fcf5c9690964f09dd6091d3e6ed2" id="r_ae545fcf5c9690964f09dd6091d3e6ed2"><td class="memItemLeft" align="right" valign="top"><a id="ae545fcf5c9690964f09dd6091d3e6ed2" name="ae545fcf5c9690964f09dd6091d3e6ed2"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>stopRecording</b> ()</td></tr>
<tr class="separator:ae545fcf5c9690964f09dd6091d3e6ed2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr><td colspan="2"><div class="groupHeader">pauseRecording</div></td></tr>
<tr><td colspan="2"><div class="groupText"><p>Pauses audio recording</p>
<p>This function pauses the audio recording. It can be resumed later using the resumeRecording() function. </p><dl class="section author"><dt>Author</dt><dd>Andres Pedreros Castro </dd></dl>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>
</div></td></tr>
<tr class="memitem:ae2270b2612639999f71ab0db118add1b" id="r_ae2270b2612639999f71ab0db118add1b"><td class="memItemLeft" align="right" valign="top"><a id="ae2270b2612639999f71ab0db118add1b" name="ae2270b2612639999f71ab0db118add1b"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>pauseRecording</b> ()</td></tr>
<tr class="separator:ae2270b2612639999f71ab0db118add1b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr><td colspan="2"><div class="groupHeader">resumeRecording</div></td></tr>
<tr><td colspan="2"><div class="groupText"><p>Resumes audio recording</p>
<p>This function resumes the audio recording after it has been paused. It continues recording from the point where it was paused. </p><dl class="section author"><dt>Author</dt><dd>Andres Pedreros Castro </dd></dl>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>
</div></td></tr>
<tr class="memitem:a0b836e4aec90f9a68fdb719a09399848" id="r_a0b836e4aec90f9a68fdb719a09399848"><td class="memItemLeft" align="right" valign="top"><a id="a0b836e4aec90f9a68fdb719a09399848" name="a0b836e4aec90f9a68fdb719a09399848"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>resumeRecording</b> ()</td></tr>
<tr class="separator:a0b836e4aec90f9a68fdb719a09399848"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr><td colspan="2"><div class="groupHeader">handlePermissionResponse</div></td></tr>
<tr><td colspan="2"><div class="groupText"><p>Handles the response to the microphone permission request</p>
<p>Emits signals based on the user's response to the permission request. If the permission is granted, it emits microphonePermissionGranted(). If the permission is denied, it emits microphonePermissionDenied(). </p><dl class="section see"><dt>See also</dt><dd>requestMicrophonePermission </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Callum Thompson </dd></dl>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>
</div></td></tr>
<tr class="memitem:a992379422df7a22d2f12609174a8a69f" id="r_a992379422df7a22d2f12609174a8a69f"><td class="memItemLeft" align="right" valign="top"><a id="a992379422df7a22d2f12609174a8a69f" name="a992379422df7a22d2f12609174a8a69f"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>handlePermissionResponse</b> ()</td></tr>
<tr class="separator:a992379422df7a22d2f12609174a8a69f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr><td colspan="2"><div class="groupHeader">playRecording</div></td></tr>
<tr><td colspan="2"><div class="groupText"><p>Plays the recorded audio file</p>
<p>This function uses the system command to play the recorded audio file. It uses the <code>afplay</code> command on macOS to play the audio file. </p><dl class="section note"><dt>Note</dt><dd>This function assumes the audio file is in a format supported by the system player. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">filePath</td><td>Path to the audio file </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Andres Pedreros Castro </dd></dl>
</div></td></tr>
<tr class="memitem:a41af8ea1c195bbe23b8322aec3ed699a" id="r_a41af8ea1c195bbe23b8322aec3ed699a"><td class="memItemLeft" align="right" valign="top"><a id="a41af8ea1c195bbe23b8322aec3ed699a" name="a41af8ea1c195bbe23b8322aec3ed699a"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>playRecording</b> (const QString &amp;filePath)</td></tr>
<tr class="separator:a41af8ea1c195bbe23b8322aec3ed699a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr><td colspan="2"><div class="groupHeader">setGoogleAIApiKey</div></td></tr>
<tr><td colspan="2"><div class="groupText"><p>Sets the Google Text-to-Speech API key</p>
<p>This function sets the Google Text-to-Speech API key for the <a class="el" href="class_audio_handler.html" title="Singleton class for handling audio recording and transcription.">AudioHandler</a> instance. It can be used to update the API key if needed. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">key</td><td>Google Text-to-Speech API key </td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Joelene Hales </dd></dl>
</div></td></tr>
<tr class="memitem:abbfb810f920ef5339c17d7cc4957d054" id="r_abbfb810f920ef5339c17d7cc4957d054"><td class="memItemLeft" align="right" valign="top"><a id="abbfb810f920ef5339c17d7cc4957d054" name="abbfb810f920ef5339c17d7cc4957d054"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>setGoogleApiKey</b> (const QString &amp;key)</td></tr>
<tr class="separator:abbfb810f920ef5339c17d7cc4957d054"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr><td colspan="2"><div class="groupHeader">setOpenAIApiKey</div></td></tr>
<tr><td colspan="2"><div class="groupText"><p>Sets the OpenAI API key</p>
<p>This function sets the OpenAI API key for the <a class="el" href="class_audio_handler.html" title="Singleton class for handling audio recording and transcription.">AudioHandler</a> instance. It can be used to update the API key if needed. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">key</td><td>OpenAI API key </td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Andres Pedreros Castro </dd></dl>
</div></td></tr>
<tr class="memitem:a8e887bf6081b25c288c607ac2599f510" id="r_a8e887bf6081b25c288c607ac2599f510"><td class="memItemLeft" align="right" valign="top"><a id="a8e887bf6081b25c288c607ac2599f510" name="a8e887bf6081b25c288c607ac2599f510"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>setOpenAIApiKey</b> (const QString &amp;key)</td></tr>
<tr class="separator:a8e887bf6081b25c288c607ac2599f510"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr><td colspan="2"><div class="groupHeader">getAudioDuration</div></td></tr>
<tr><td colspan="2"><div class="groupText"><p>Retrieves the duration of an audio file</p>
<p>This function reads the audio file and calculates its duration based on the file size and audio format. It assumes a specific format (16-bit PCM, 2 channels, 48000Hz) for the calculation. </p><dl class="section note"><dt>Note</dt><dd>This function is specific to WAV files and may not work for other audio formats. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">audioPath</td><td>Path to the audio file </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Duration of the audio file in seconds </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Andres Pedreros Castro </dd></dl>
</div></td></tr>
<tr class="memitem:aeeacd2c0f66665a7eb01b5a67149a860" id="r_aeeacd2c0f66665a7eb01b5a67149a860"><td class="memItemLeft" align="right" valign="top"><a id="aeeacd2c0f66665a7eb01b5a67149a860" name="aeeacd2c0f66665a7eb01b5a67149a860"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>getAudioDuration</b> (const QString &amp;path) const</td></tr>
<tr class="separator:aeeacd2c0f66665a7eb01b5a67149a860"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-static-methods" name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr><td colspan="2"><div class="groupHeader">getInstance</div></td></tr>
<tr><td colspan="2"><div class="groupText"><p>Returns the singleton instance of <a class="el" href="class_audio_handler.html" title="Singleton class for handling audio recording and transcription.">AudioHandler</a></p>
<p>If the instance does not exist, it creates a new one. This ensures that only one instance of <a class="el" href="class_audio_handler.html" title="Singleton class for handling audio recording and transcription.">AudioHandler</a> exists throughout the application. </p><dl class="section note"><dt>Note</dt><dd>This is a singleton pattern implementation. </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Joelene Hales </dd></dl>
<dl class="section return"><dt>Returns</dt><dd>Singleton instance of <a class="el" href="class_audio_handler.html" title="Singleton class for handling audio recording and transcription.">AudioHandler</a> </dd></dl>
</div></td></tr>
<tr class="memitem:ab431a9dbaab18740bc72f3e8d418691a" id="r_ab431a9dbaab18740bc72f3e8d418691a"><td class="memItemLeft" align="right" valign="top"><a id="ab431a9dbaab18740bc72f3e8d418691a" name="ab431a9dbaab18740bc72f3e8d418691a"></a>
static <a class="el" href="class_audio_handler.html">AudioHandler</a> *&#160;</td><td class="memItemRight" valign="bottom"><b>getInstance</b> ()</td></tr>
<tr class="separator:ab431a9dbaab18740bc72f3e8d418691a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Singleton class for handling audio recording and transcription. </p>
<p>This class provides methods to record audio, transcribe it using Google Speech API, and manage microphone permissions. It uses QMediaRecorder for recording and QNetworkAccessManager for sending audio data to the API. The class is designed as a singleton to ensure that only one instance exists throughout the application. </p><dl class="section note"><dt>Note</dt><dd>The class is not thread-safe and should be used in a single-threaded context. </dd></dl>
</div><hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="audiohandler_8h_source.html">audiohandler.h</a></li>
<li><a class="el" href="audiohandler_8cpp.html">audiohandler.cpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="class_audio_handler.html">AudioHandler</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
</body>
</html>
